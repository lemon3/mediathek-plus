// ==UserScript==
// @name         ORF DL
// @namespace    https://github.com/lemon3/
// @version      0.7.2
// @description  orf tvthek video download helper
// @author       lemon3
// @match        https://on.orf.at/*
// @icon         https://raw.githubusercontent.com/lemon3/orfdl/main/_assets/dl.svg
// @grant        none
// @run-at       document-end
// @license      MIT
// @copyright    lemon3
// @homepage     https://github.com/lemon3/orfdl
// @updateURL    https://raw.githubusercontent.com/lemon3/orfdl/main/dist/orfdl.meta.js
// @downloadURL  https://raw.githubusercontent.com/lemon3/orfdl/main/dist/orfdl.user.js
// ==/UserScript==

var se=Object.defineProperty;var F=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable;var E=(d,l,r)=>l in d?se(d,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):d[l]=r,z=(d,l)=>{for(var r in l||(l={}))ne.call(l,r)&&E(d,r,l[r]);if(F)for(var r of F(l))oe.call(l,r)&&E(d,r,l[r]);return d};var c=(d,l,r)=>(E(d,typeof l!="symbol"?l+"":l,r),r);var D=(d,l,r)=>new Promise((a,b)=>{var A=g=>{try{M(r.next(g))}catch(x){b(x)}},L=g=>{try{M(r.throw(g))}catch(x){b(x)}},M=g=>g.done?a(g.value):Promise.resolve(g.value).then(A,L);M((r=r.apply(d,l)).next())});(function(){"use strict";const d="body.dragging>*{-webkit-touch-callout:none;-webkit-user-select:none;user-select:none}#l3-5013{--color-1: #000;--color-2: #222;--color-3: #72bbe9;--color-4: #c9c9c9;--color-5: #222222;--color-6: #555555;--color-7: #aedaf5;--font-small: 12px;--font-tiny: 10px}#l3-5013{position:fixed;top:0;left:0;z-index:99999;font-family:Arial,Helvetica Neue,Helvetica,sans-serif;color:var(--color-4)}.l3-5013-info{font-size:var(--font-small)}#l3-5013-body .l3-5013-info{padding:15px}#l3-5013-clear{color:var(--color-1);background-color:var(--color-3);width:32px;height:38px;box-sizing:border-box;flex:none;text-align:center;justify-content:center;padding:.5em;cursor:pointer}#l3-5013-header{width:100%;padding:15px}#l3-5013-header.hidden{display:none}.l3-5013-buttons{display:flex;font-size:14px;gap:.5em}.l3-5013-button{font-size:var(--font-small);color:var(--color-4);background-color:var(--color-5);cursor:pointer;display:flex;flex:1 1 auto;justify-content:center;text-align:center;width:50%;padding:.5em;border-radius:6px}.l3-5013-button.active{color:var(--color-2);background-color:var(--color-3)}.l3-5013-button.active:hover{background-color:var(--color-7)}#l3-5013-filter{display:flex;align-items:stretch;margin-top:.5em}#l3-5013-filter.hidden{display:none}#l3-5013-content{max-height:260px;overflow:scroll}#l3-5013-close{z-index:999999;position:absolute;top:19px;left:15px;padding:0;background-image:url(data:image/svg+xml;base64,PHN2ZyBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCAyNTYgMjU2IiB2aWV3Qm94PSIwIDAgMjU2IDI1NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSIjZmZmIj48cGF0aCBkPSJtMjQzLjIgMTE5LjZ2MTYuOGgtMjMwLjR2LTE2Ljh6Ii8+PHBhdGggZD0ibTI0My4yIDE3NC42djE2LjhoLTIzMC40di0xNi44eiIvPjxwYXRoIGQ9Im0yNDMuMiA2NC42djE2LjhoLTIzMC40di0xNi44eiIvPjwvZz48L3N2Zz4=);background-repeat:no-repeat;width:38px;height:38px;background-size:20px;background-color:var(--color-1);border-radius:50%;background-position:center center;box-shadow:0 2px 12px -3px #fffc;cursor:pointer;user-select:none}#l3-5013-close.open{background-image:url(data:image/svg+xml;base64,PHN2ZyBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCAyNTYgMjU2IiB2aWV3Qm94PSIwIDAgMjU2IDI1NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJtMjQ2LjUgMjM0LjctMTA2LjctMTA2LjcgMTA2LjctMTA2LjctMTEuOC0xMS45LTEwNi43IDEwNi43LTEwNi43LTEwNi42LTExLjggMTEuOSAxMDYuNiAxMDYuNi0xMDYuNiAxMDYuNiAxMS44IDExLjkgMTA2LjctMTA2LjYgMTA2LjcgMTA2Ljd6IiBmaWxsPSIjZmZmIi8+PC9zdmc+)}#l3-5013-field{font-size:16px;touch-action:none;padding:8px;height:38px;border:0;border-radius:0;color:var(--color-2);width:100%}#l3-5013-field:focus{outline:none}#l3-5013-box{z-index:999999;box-sizing:border-box;margin:0;top:64px;max-width:280px;width:280px;background-color:var(--color-1);transform:translate(-100%);position:relative;transition:transform .1s ease-out;border:1px solid var(--color-5);box-shadow:0 2px 12px -3px #fffc;border-radius:6px}#l3-5013-box.open{transform:translate(0);transition:transform .2s ease-out}.l3-5013-actions{display:flex;flex-direction:column;gap:.5em}.l3-5013-action{width:36px;height:36px;background-color:var(--color-3);display:flex;background-size:70%;background-repeat:no-repeat;background-position:center center;flex:none;border:none;border-radius:6px}.l3-5013-newTab{background-image:url(data:image/svg+xml;base64,PHN2ZyBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCAyNTYgMjU2IiB2aWV3Qm94PSIwIDAgMjU2IDI1NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSIjMWQxZDFiIj48cGF0aCBkPSJtMjMzLjYgMjYuNGgtMTY3LjJjLTQuMSAwLTcuNSAzLjQtNy41IDcuNXYzOC4zaC0zNi41Yy00LjEgMC03LjUgMy40LTcuNSA3LjV2MTQwLjVjMCA0LjEgMy40IDcuNSA3LjUgNy41aDE2Ny4yYzQuMSAwIDcuNS0zLjQgNy41LTcuNXYtMzguMmgzNi42YzQuMSAwIDcuNS0zLjQgNy41LTcuNXYtMTQwLjZjLS4xLTQuMS0zLjQtNy41LTcuNi03LjV6bS01MS41IDE4Ni40aC0xNTIuMnYtMTI1LjVoMjkuMXY4Ny4yYzAgNC4xIDMuNCA3LjUgNy41IDcuNWgxMTUuN3YzMC44em00NC00NS44aC0yOS4xLTE1LTEwOC4xdi03OS43LTE1LTMwLjloMTUyLjJ6Ii8+PHBhdGggZD0ibTE5NS4yIDk2LjdoLTM3Ljd2LTM0YzAtNC4xLTMuNC03LjUtNy41LTcuNXMtNy41IDMuNC03LjUgNy41djM0aC0zNy43Yy00LjEgMC03LjUgMy40LTcuNSA3LjVzMy40IDcuNSA3LjUgNy41aDM3Ljd2MzRjMCA0LjEgMy40IDcuNSA3LjUgNy41czcuNS0zLjQgNy41LTcuNXYtMzRoMzcuN2M0LjEgMCA3LjUtMy40IDcuNS03LjVzLTMuMy03LjUtNy41LTcuNXoiLz48L2c+PC9zdmc+)}.l3-5013-shareBtn{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCI+PHBhdGggZD0iTTE1Ljk4NCA1LjAxNmwtMS40MDYgMS40MDYtMS41OTQtMS41OTR2MTEuMTU2aC0xLjk2OVY0LjgyOEw5LjQyMSA2LjQyMiA4LjAxNSA1LjAxNiAxMS45OTkuOTg1em00LjAzMiA0Ljk2OFYyMXEwIC44NDQtLjU4NiAxLjQzdC0xLjQzLjU4Nkg2cS0uODQ0IDAtMS40My0uNTg2VDMuOTg0IDIxVjkuOTg0cTAtLjc5Ny41ODYtMS4zODNUNiA4LjAxNWgzdjEuOTY5SDZWMjFoMTJWOS45ODRoLTNWOC4wMTVoM3EuODQ0IDAgMS40My41ODZ0LjU4NiAxLjM4M3oiLz48L3N2Zz4=)}.l3-5013-action:hover{background-color:var(--color-7);cursor:pointer}.l3-5013-result{padding:1em}.l3-5013-result:nth-child(odd){background-color:var(--color-5)}.l3-5013-main{display:flex;flex-flow:row nowrap;gap:.5em}.l3-5013-bar{font-size:var(--font-small);display:flex;justify-content:space-between;align-items:center;margin-bottom:.5em}.l3-5013-title{font-size:var(--font-small);display:flex;width:100%;flex:1 0 100%;padding:.5em .5em .5em 0;line-height:1.4em}.l3-5013-imgWrap{display:flex;flex:1 1 auto;position:relative;cursor:pointer}.l3-5013-imgWrap img{max-width:100%}.l3-5013-copy{font-size:25px;position:absolute;text-align:center;width:100%;background-color:#0006;padding:6px;transition:opacity ease-out .2s;display:flex;justify-content:center;align-self:center}#l3-5013 .success .l3-5013-copy{opacity:1}.l3-5013-imgWrap.active{box-shadow:0 0 0 2px #ffff54;filter:brightness(1.2)}#l3-5013-footer{font-size:var(--font-tiny);text-align:right;padding:.5em}",l=(n,e,t)=>{if(n=parseFloat(n,10),e=parseFloat(e,10),t=parseFloat(t,10),t<e){let s=t;t=e,e=s}return!isNaN(e)&&n<e?e:!isNaN(t)&&n>t?t:n},r=(n,e,t)=>{if(e)for(let s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.setAttribute(s,e[s]);if(t)for(let s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n.style[s]=t[s]);return n},a=(n,e,t)=>r(document.createElement(n),e,t),b=(n="cs",e=window)=>{var t=document.createElement("iframe");t.src="about:blank",t.style.display="none",document.body.appendChild(t);const s=t.contentWindow.console;return e[n]=s};class A{constructor(){}get(e,t){let s=localStorage.getItem(e);if(!s)return!1;let o=JSON.parse(s);return t?o[t]:o}set(e,t){const s=this.get(e)||{},o=z(z({},s),t);let i=JSON.stringify(o);localStorage.setItem(e,i)}}let L=!1;try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){return L={passive:!1},!1}}))}catch(n){L=!1}const H={name:"orfdl",displayName:"ORF DL",version:"0.7.2",type:"module",description:"orf tvthek video download helper",main:"index.js",author:"lemon3",license:"MIT",scripts:{dev:"vite",build:"vite build",preview:"vite preview",lint:"eslint 'src/**/*.js' || true",prettify:"prettier --write 'src/**/*.*'",browserslistupdate:"npx update-browserslist-db@latest"},devDependencies:{eslint:"^9.3.0",prettier:"^3.2.5",vite:"^5.2.11","vite-plugin-banner":"^0.7.1","vite-plugin-create-file":"^0.1.0","vite-plugin-string-replace":"^1.1.2"},dependencies:{globals:"^15.3.0"}},U=b("cs"),v={btn:"Auf das Bild klicken um den video-link in die Zwischenablage zu kopieren",nothingFound:"Auf dieser Seite gibt es kein Video!",filterVideos:"Beiträge filtern ...",shareVideo:"Video Link teilen",openTab:"Video Link in neuem Tab öffnen",completeBroadcast:"Ganze Sendung anzeigen",individualPosts:"Einzelne Beiträge anzeigen"},V=H.version;let Z="Q8C",Q="hls";const W=d.toString();let f;const k=n=>{n.advertising_mapping={},n.advertising_query_string="",n.adition_advertising_query_string="",n.show_display_ads=!1,n.show_instream_ads=!1,n.youth_protection=void 0,n.age_classification=void 0,n.disable_display_ads_orf_platforms=!0,n.disable_instream_ads_orf_platforms=!0},T=(n,e=2)=>("0"+n).slice(-e),G=n=>{let e=n.target.nextElementSibling;if(e.select(),navigator.clipboard){let t=e.innerHTML;return navigator.clipboard.writeText(t).then(()=>console.log("successful"),s=>console.log("error",s))}return document.execCommand("copy")},X=n=>{if(!navigator.share)return!1;const e=n.target,t=e.dataset.shareTitle,s=e.dataset.shareUrl;navigator.share({title:t,url:s}).then(()=>console.log("successful share")).catch(o=>console.log("error sharing:",o))},B=n=>{let e;return typeof n.clientX!="undefined"?e=n:e=n.touches[0]||n.changedTouches[0],{x:e.clientX,y:e.clientY}};class j{constructor(e){c(this,"renderSearchResults",e=>{if(this.contentDiv.innerHTML="",!e.length)return null;const t="div",s=new DocumentFragment;for(let o=e.length-1;o>=0;o--){const i=e[o],h=a(t,{class:"l3-5013-result"}),m=a(t,{class:"l3-5013-bar"}),u=a(t,{class:"l3-5013-title"});u.innerHTML=i.title;const y=a("textarea",{class:"l3-5013-ta",disabled:"true"},{position:"absolute",left:"-999em",opacity:0}),w=a(t,{class:"l3-5013-imgWrap",title:v.btn}),p=a(t,{class:"l3-5013-copy"},{display:"none"});p.innerHTML="copied";const O=a("img",{src:i.img,width:"150"},{flex:"auto"});O.dataset.drm=i.drm===null?!1:i.drm;let C="";if(!i.drm){const $=i.date.getFullYear(),R=T(+i.date.getMonth()+1),J=T(i.date.getDate()),q=T(i.date.getHours()),K=T(i.date.getMinutes()),ee=`${$}-${R}-${J}`,te=`${q}${K}`;let _=i.title.toLowerCase().replaceAll('"',"");_.replaceAll("'","");const ie=`${ee}_${te}_${_}.mp4`;C=`yt-dlp ${i.link} -o '${ie}'`;const P=a("div",{class:"l3-5013-actions"}),N=a("button",{class:"l3-5013-action l3-5013-shareBtn"});N.dataset.share=!0,N.dataset.shareUrl=i.link,N.title=v.shareVideo;const S=a("a",{class:"l3-5013-action l3-5013-newTab"});S.target="_blank",S.href=i.link,S.title=v.openTab,P.append(S,N),m.append(P)}y.innerHTML=C,w.append(O,y,p);const Y=a("div",{class:"l3-5013-main"});Y.append(w,m),h.append(u,Y),s.append(h)}this.contentDiv.append(s)});c(this,"contentClicked",e=>{const t=e.target;if(this.currentActive&&(this.currentActive.classList.remove("active"),this.currentActive.querySelector(".l3-5013-copy").style.display="none"),t.nodeName.toLocaleLowerCase()==="img"&&t.dataset.drm&&t.dataset.drm==="false"){if(G(e)){const o=t.parentElement,i=o.querySelector(".l3-5013-copy");clearTimeout(f),i.style.display="block",f=setTimeout(()=>{o.classList.add("active"),o.classList.add("success"),f=setTimeout(()=>{o.classList.remove("success"),f=setTimeout(()=>{i.style.display="none"},200)},500)},1),this.currentActive=o}}else t.nodeName.toLocaleLowerCase()==="button"&&typeof t.dataset.share!="undefined"&&X(e)});c(this,"dragStart",e=>{this.moved=!1,document.body.classList.add("dragging"),e.stopPropagation(),e.type==="touchstart"?(this.closeBtn.removeEventListener("mousedown",this.dragStart),window.addEventListener("touchmove",this.drag,L),window.addEventListener("touchend",this.dragEnd,!1)):e.type==="mousedown"&&(this.closeBtn.removeEventListener("touchstart",this.dragStart),window.addEventListener("mousemove",this.drag,!1),window.addEventListener("mouseup",this.dragEnd,!1))});c(this,"drag",e=>{e.preventDefault();let t=B(e);this.moved=!0,this.setPos(t)});c(this,"dragEnd",e=>{e.type==="touchend"?(window.removeEventListener("touchmove",this.drag,L),window.removeEventListener("touchend",this.dragEnd)):e.type==="mouseup"&&(window.removeEventListener("mousemove",this.drag,!1),window.removeEventListener("mouseup",this.dragEnd,!1));let{x:t,y:s}=B(e);this.store.set(this.name,{posX:t,posY:s}),document.body.classList.remove("dragging")});c(this,"open",()=>{this.mainDiv.style.display="block",f=setTimeout(()=>{this.mainDiv.classList.add("open"),this.closeBtn.classList.add("open"),this.searchField&&this.searchField.focus(),this.isOpen=!0,this.store.set(this.name,{open:this.isOpen}),clearTimeout(f)},1)});c(this,"close",()=>{this.mainDiv.classList.remove("open"),this.closeBtn.classList.remove("open"),f=setTimeout(()=>{this.mainDiv.style.display="none",this.isOpen=!1,this.store.set(this.name,{open:this.isOpen}),clearTimeout(f)},100)});c(this,"toggle",()=>{if(this.moved)return!1;this.isOpen?this.close():this.open()});c(this,"orfOnFetchData",()=>D(this,null,function*(){let e=0,t;return new Promise((s,o)=>{const i=()=>{window.__NUXT__||o(),e++;const h=window.__NUXT__.data,m=Object.entries(h);let u=[];if(m.forEach(y=>{const[w,p]=y;if(p.sources){u.push(p),k(p),this.currentKey=w;return}}),u.length){const y=u.filter(w=>document.location.pathname.match(w.id));return e=0,s(y[0])}else{if(e>20)return clearTimeout(t),t=null,o();t=setTimeout(()=>i(),150)}};i()})}));c(this,"clear",()=>{this.searchField.value="",this.searchField.dispatchEvent(new Event("input")),this.searchField.focus()});c(this,"onInput",e=>{const t=e.currentTarget.value;this.searchNow(t),this.toggleClearBtn(t==="")});c(this,"createDataObject",()=>D(this,null,function*(){let e;try{return e=yield this.orfOnFetchData(),e&&(e=this.createOrfOn(e)),e}catch(t){return console.log(t),!1}}));c(this,"showAll",e=>{if(e&&this.activeTab===1)return!1;this.showAllButton.classList.add("active"),this.showSegmentsButton.classList.remove("active");const t=this.findData("*");this.filterElement.classList.add("hidden"),this.renderSearchResults(t),this.setActiveTab(1)});c(this,"showSegments",e=>{if(e&&this.activeTab===2)return!1;this.showAllButton.classList.remove("active"),this.showSegmentsButton.classList.add("active"),this.filterElement.classList.remove("hidden");let t=this.oldSearchString||this.searchField.value;this.toggleClearBtn(!t),this.searchField.focus(),this.oldSearchString=null,this.searchNow(t),this.setActiveTab(2)});c(this,"resize",()=>{this.windowWidth=window.innerWidth,this.windowHeight=window.innerHeight});c(this,"reInit",()=>{this.currentKey=null,this.autoSearch=this.oldSearchString,this.oldSearchString=null,this.contentDiv.innerHTML="",this.start()});c(this,"start",()=>D(this,null,function*(){if(this.dataObject=yield this.createDataObject(),!this.dataObject||!this.dataObject.length){this.header.classList.add("hidden"),this.contentDiv.innerHTML=`<div class="l3-5013-result" style="text-align:center;">${v.nothingFound}</div>`;return}if(this.dataObject&&this.dataObject.length===2){this.header.classList.add("hidden");const t=this.dataObject.filter(o=>o.type==="single");this.renderSearchResults(t),U.log(t);const s=document.querySelector(".content .buttons");if(s){const o=a("button",{class:"button s-48 tertiary"});o.addEventListener("click",i=>{i.preventDefault(),window.open(t[0].link,"_blank")}),setTimeout(()=>{o.innerHTML="Abspielen",s.append(o)},200)}return}this.header.classList.remove("hidden"),this.searchField.value=this.autoSearch,this.activeTab===1?this.showAll():this.showSegments()}));this.settings=Object.assign({},j.defaults,e),this.name="dl-app",this.autoSearch="",this.oldSearchString=null,this.dataObject=[],this.currentSite=window.location.href,this.createWatcher(),this.settings.createGui&&this.createApp(),this.store=new A,this.init()}createWatcher(){const e=document.querySelector('[property="og:url"]'),t={attributes:!0},s=i=>{for(const h of i)h.type==="attributes"&&window.location.href!==this.currentSite&&(this.reInit(),this.currentSite=window.location.href)};return new MutationObserver(s).observe(e,t),!0}setPos({x:e,y:t}){e-=19,t-=19,e=l(e,0,this.windowWidth-38),t=l(t,0,this.windowHeight-38),this.closeBtn.style.left=e+"px",this.closeBtn.style.top=t+"px",this.x=e,this.y=t}findData(e){if(!this.dataObject)return null;const t=e==="*"?"all":"single";return this.dataObject.filter(o=>o.type===t&&(e==="*"||o.title.toLowerCase().match(e.replaceAll("*",".*").toLowerCase())))}searchNow(e){if(this.oldSearchString===e)return;const t=this.findData(e);this.renderSearchResults(t),this.store.set(this.name,{search:e}),this.oldSearchString=e}toggleClearBtn(e){if(e){this.clearBtn.style.display="none",this.clearBtnVisible=!1;return}this.clearBtnVisible||(this.clearBtn.style.display="flex",this.clearBtnVisible=!0)}createOrfOn(e){window.playerObject=e;const t=[],s=(i,h="single")=>{k(i);let m=null,u=i.date||i.episode_date;if(u=new Date(u),i.sources[Q].forEach(p=>{p.quality_key.toLocaleLowerCase()==="qxa"&&(m=p.src.replace("QXA",Z))}),!m)return!1;const y=typeof i.is_drm_protected!="undefined"?i.is_drm_protected:null;return{type:h,title:i.headline||i.title,drm:y,date:u,link:m,img:i.image&&i.image.image&&i.image.image.player&&i.image.image.player.url||null}},o=s(e,"all");return o&&t.push(o),e.segments&&e.segments.forEach(i=>{const h=s(i);h&&t.push(h)}),t}createApp(){const e="div",t=a(e,{id:"l3-5013"}),s=a(e,{id:"l3-5013-body"});this.mainDiv=a(e,{id:"l3-5013-box"},{display:"none"}),this.header=a(e,{id:"l3-5013-header"}),this.showAllButton=a(e,{class:"l3-5013-button"}),this.showAllButton.innerHTML=v.completeBroadcast,this.showSegmentsButton=a(e,{class:"l3-5013-button"}),this.showSegmentsButton.innerHTML=v.individualPosts,this.buttons=a(e,{class:"l3-5013-buttons"}),this.buttons.append(this.showAllButton,this.showSegmentsButton),this.header.append(this.buttons),this.filterElement=a(e,{id:"l3-5013-filter"}),this.searchField=a("input",{type:"text",id:"l3-5013-field",name:"fake_user[name]",value:"",autocomplete:"new-password",spellcheck:"false","aria-autocomplete":"none",placeholder:v.filterVideos}),this.clearBtn=document.createElement(e),this.clearBtn.id="l3-5013-clear",this.clearBtn.innerHTML="X",this.toggleClearBtn(!0),this.filterElement.append(this.searchField,this.clearBtn),this.header.append(this.filterElement),this.clearBtn.addEventListener("click",this.clear,!1),this.searchField.addEventListener("input",this.onInput,!1),this.mainDiv.append(this.header),this.closeBtn=a(e,{id:"l3-5013-close"}),this.closeBtn.addEventListener("click",this.toggle),this.closeBtn.addEventListener("mousedown",this.dragStart),this.closeBtn.addEventListener("touchstart",this.dragStart,L),this.contentDiv=a(e,{id:"l3-5013-content"});const o=a(e,{id:"l3-5013-footer"});o.innerHTML=`v-${V}`,s.append(this.contentDiv),this.mainDiv.append(s,o),t.append(this.mainDiv,this.closeBtn);const i=a("style");i.innerHTML=W,document.body.append(i),document.body.append(t),t.addEventListener("click",this.contentClicked),this.showAllButton.addEventListener("click",this.showAll),this.showSegmentsButton.addEventListener("click",this.showSegments),this.app=t}setActiveTab(e){this.store.set(this.name,{activeTab:e}),this.activeTab=e}init(){if(this.appInitialized)return!1;this.appInitialized=!0;let e=this.store.get(this.name);this.activeTab=1,e&&(typeof e.search!="undefined"&&(this.autoSearch=e.search),typeof e.open!="undefined"&&(this.isOpen=e.open),typeof e.posX!="undefined"&&typeof e.posY!="undefined"&&this.setPos({x:e.posX,y:e.posY}),typeof e.activeTab!="undefined"&&(this.activeTab=+e.activeTab)),this.start(),this.isOpen&&(this.mainDiv.classList.add("open"),this.mainDiv.style.display="block",this.closeBtn.classList.add("open"))}}j.defaults={createGui:!0};const I=()=>{if(window.orfdl_initialized)return!1;window.orfdl_initialized=!0,new j};window.top===window.self&&(document.readyState==="complete"||document.readyState==="interactive"?(I(),document.removeEventListener("DOMContentLoaded",I)):document.addEventListener("DOMContentLoaded",I,!1))})();
